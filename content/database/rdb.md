---
title: "Rdb"
date: 2020-02-28T13:39:56+09:00
categories: ["database"]
---

# 관계형 데이터베이스

- 논리적 설계
  - 논리적 설계는 ER 다이어그램을 데이터베이스 관리 시스템에 매핑(Mapping, 사상)하는 것
- 관계형 데이터베이스의 용어와 식별자 유형
  - 관계(테이블 또는 릴레이션)
    - 테이블이라는 이름으로 사용
    - 관계의 행은 튜플, 열은 애트리뷰트라고 하며 실제 데이터의 값이 들어감
  - 튜플(레코드 또는 행)
    - 관계를 구성하는 각각의 행을 의미하며, 애트리뷰트의 모임으로 구성
  - 애트리뷰트(속성 또는 열)
    - 데이터베이스를 구성하는 가장 작은 논리적 단위이며, 개체의 특성을 기술
  - 도메인
    - 애트리뷰트가 취할 수 있는 같은 타입의 원자 값들의 집합을 의미
    - 실제 애트리뷰트 값이 나타날 때, 그 값의 적절성을 시스템이 판단하는 데 이용
- 요구사항 분석 -> 개념적 설계(ERD) -> 논리적 설계(정규화) -> 물리적 설계(성능(인덱스/저장구조)) -> 구현

## 관계형 데이터베이스의 용어와 식별자 유형

- 슈퍼키
  - 관계에서 같은 튜플이 발생하지 않는 키를 구성할 때, 애트리뷰트의 집합으로 구성하는 것
  - 유일성을 만족하는 애트리뷰트들의 집합
- 후보키
  - 관계를 구성하는 애트리뷰트들 중에서 튜플을 유일하게 식별하려고 사용하는 애트리뷰튜들의 부분 집합, 즉 기본키로 사용할 수 있는 애트리뷰트들을 의미
  - 슈퍼키 중 최소성 만족하는 키
- 기본키
  - 후보키 중에서 선택한 주 키
  - 널(Null)을 값으로 가질 수 없음
  - 동일한 값이 중복해서 저장될 수 없음
- 대체키
  - 후보키 중에서 선택되지 못한 키
- 외래키
  - 관계를 맺는 두 릴레이션에서 참조하는 릴레이션에 애트리뷰트로 지정되는 키 값을 말함

## 관계형 데이터베이스에서의 제약조건

- 참조 무결성 제약조건
  - 한 릴레이션에 있는 튜플이 다른 릴레이션에 있는 튜플을 참조하려면 반드시 참조되는 튜플이 해당 릴레이션 내에 있어야 한다는 것을 의미
- 키 제약 조건
  - 키 애트리뷰트의 값은 릴레이션 내의 각 튜플을 유일하게 식별해야 함
- 도메인 제약 조건
  - 각 애트리뷰트의 값은 반드시 도메인에 속하는 원자 값이어야 함

## 제약조건의 위배에 따른 처리

- 삽입 연산
    - 삽입되는 튜플의 애트리뷰트 값이 도메인에 없으면 도메인 제약조건을 위반함
- 삭제 연산
    - 다른 테이블에서 참조하고 있는 튜플을 삭제하면 참조 무결성 제약조건을 위반함
- 수정 연산
    - 수정 연산은 기본적으로 삭제 연산 후 삽입 연산이 이루어지는 것이므로 삽입과 삭제 시의 문제점이 모두 나타남
- 제한(restricted)
    - 위배를 야기한 연산을 단순히 거절
- 연쇄
    - 참조되는 릴레이션에서 튜플을 삭제하고, 참조하는 릴레이션에서 이 튜플을 참조하는 튜플들도 함께 삭제
- 널 값(nullify)
    - 참조되는 릴레이션에서 튜플을 삭제하고, 참조하는 릴레이션에서 이 튜플을 참조하는 튜플들의 외래키에 널 값을 삽입
- 디폴트 값
    - 널 값을 넣는 대신에 디폴트 값을 넣는다는 것을 제외하고는 바로 위의 옵션과 비슷함

## 관계형 스키마 작성

- 개념적 설계 : 개념 스키마(ER 다이어그램)
- 논리적 설계 : 논리적 스키마(관계형 스키마)

## ER 다이어그램을 관계형 스키마로 매핑하는 변환 과정

- 1단계: 엔티티 타입의 변환
- 2단계: 약한 엔티티 타입의 변환
- 3단계: 관계 타입(1:1)의 변환
- 4단계: 관계 타입(1:N)의 변환
- 5단계: 관계 타입(M:N)의 변환
- 6단계: 다치 애트리뷰트의 변환
- 7단계: N차 관계타입의 변환

## 엔티티 타입을 관계형 스키마로 매핑

- 엔티티 E1에 대해서 E1의 기본키를 포함한 모든 단순 애트리뷰트를 포함하는 릴레이션 E1를 생성한 것
- 애트리뷰트 B는 유도된 애트리뷰트
- ER 다이어그램을 관계형 스키마로 매핑할 때 모든 단계에서 유도된 애트리뷰트는 릴레이션에 포함할 것인가 포함하지 않을 것인가는 설계자의 선택에 달림

## 약한 엔티티 타입을 관계형 스키마로 매핑

- 소유 엔티티 E1을 갖는 약한 엔티티 E2에 대해 모든 단순 애트리뷰트를 포함시키고, E1의 기본키를 외래키로 하는 릴레이션 E2를 생성한 것 (복합키)

## 1:1 관계 타입의 변환

- 릴레이션 E2는 앞의 단계에서 변환된 대로 남아 있고 릴레이션 E1은 앞의 단계에 변환된 내용에 관계 타입에서 변환된 내용이 추가됨
- 즉, 관계 타입이 변환되면서 외래키 D가 추가되고, 관계 타입의 애트리뷰트인 C가 추가됨

## 1:N 관계 타입의 변환

- 1:N 관계를 맺은 엔티티 타입 E1과 E2와 관계 타입 R이 있음
- N측에 해당하는 것은 엔티티 타입 E2이므로 E1에 있는 기본키를 E2에 대응하는 릴레이션의 외래키로 포함시킴

## M:N 관계 타입의 변환

- 두 엔티티 E1가 E2는 이진 M:N 관계
- 변환 규칙에 의해 관계 R은 릴레이션 R로 변환됨
- R의 애트리뷰트였던 C는 릴레이션 R의 애트리뷰트가 됨
- 관계에 참여했던 E1의 기본키 A와 E2의 기본키 D는 릴레이션 R의 외래키로 참여하게 됨
- 외래키 A와 D의 조합은 릴레이션 R의 기본키가 됨

## 다치 애트리뷰트를 관계형 스키마로 매핑

- 다치 애트리뷰트에 대해 새로운 릴레이션을 생성하고, 다치 애트리뷰트를 포함시킴
- A가 속해 있던 엔티티 타입 E1의 기본키인 PK를 외래키로 참여시킴
- 그리고 이 둘을 조합해서 릴레이션 A의 기본키로 둠

## 3차 관계 타입을 관계형 스키마로 매핑

- 3개의 엔티티 타입과 N차 관계 타입을 갖는 R이 존재함
- 각 엔티티를 릴레이션으로 변환 후, N차 관계 타입 R에 대응하는 릴레이션 R을 생성
- 관계 R의 애트리뷰트인 C1는 릴레이션 R의 애트리뷰트가 되고, 관계 타입 R에 연결되어 있는 모든 엔티티 타입의 키 애트리뷰트들은 조합해서 R의 키가 되고, 각각은 외래키가 됨

## ER 다이어그램과 관계 모델과의 대응 관계

- ER 모델 : 관계 모델
- 엔티티 타입 : 릴레이션
- 1:1 또는 1:N 관계 타입 : 외래키(또는 관계 릴레이션)
- M:N 관계 타입 : 릴레이션과 두 외래키
- N차 관계 타입 : 관계 릴레이션과 N개의 외래키
- 단순 애트리뷰트 : 애트리뷰트
- 복합 애트리뷰트 : 단순 애트리뷰트들의 집합
- 다치 애트리뷰트 : 릴레이션과 외래키
- 값의 집합 : 도메인
- 키 애트리뷰트 : 기본키
